id: zabbix-detect

info:
  name: Zabbix Detect
  author: rix4uni
  severity: info
  description: description
  reference:
    - https://
  metadata:
    shodan-query:
      - http.favicon.hash:892542951
      - http.favicon.hash:2126845402
      - http.favicon.hash:1045955894
    fofa-query:
      - body="Zabbix</title>"
  tags: tech,zabbix

http:
  - method: GET
    path:
      - "{{BaseURL}}"
      # - "{{BaseURL}}/favicon.ico"
      # - "{{BaseURL}}/images/general/zabbix.ico"

    stop-at-first-match: true
    matchers-condition: and
    matchers:
      - type: regex
        regex:
          - "Zabbix ([0-9.]+)"
          - "zabbix'@'localhost"
          - "images/general/zabbix.ico"
          - 'content="Zabbix SIA"'
          - "Zabbix</title>"

      # - type: dsl
      #   dsl:
      #     - "status_code==200 && (\"892542951\" == mmh3(base64_py(body)))"
      #     - "status_code==200 && (\"2126845402\" == mmh3(base64_py(body)))"
      #     - "status_code==200 && (\"1045955894\" == mmh3(base64_py(body)))"

      - type: status
        status:
          - 200