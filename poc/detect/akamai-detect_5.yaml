id: akamai-detect

info:
  name: akamai cdn detection
  author: pdteam
  severity: info
  reference:
    - https://support.globaldots.com/hc/en-us/articles/115003996705-Akamai-Pragma-Headers-overview
    - https://community.akamai.com/customers/s/article/Using-Akamai-Pragma-headers-to-investigate-or-troubleshoot-Akamai-content-delivery?language=en_US
    - https://spyclub.tech/2022/12/14/unusual-cache-poisoning-akamai-s3/
  metadata:
    max-request: 1
  tags: akamai,cdn,tech,discovery

http:
  - method: GET
    path:
      - "{{BaseURL}}"

    headers:
      Pragma: akamai-x-cache-on
    matchers:
      - type: word
        part: x_cache
        words:
          - "deploy.akamai"
# digest: 4b0a00483046022100a6e58dbf35949e91a77d332299d5892d65102ec6b162b08d0d52a5257f240916022100a42487fa10ff423f3596c8c32befc4a9cbfd2c3db76d105c2d28f3436415dd36:922c64590222798bb761d5b6d8e72950