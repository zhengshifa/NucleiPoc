id: versa-networks-detect

info:
  name: Versa Networks Detection
  author: c-sh0
  severity: info
  reference:
    - https://versa-networks.com/products/components/
  classification:
    cpe: cpe:2.3:a:versa-networks:versa_analytics:*:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 7
    vendor: versa-networks
    product: versa_analytics
    shodan-query: html:"Versa Networks"
  tags: tech,versa,discovery

http:
  - method: GET
    path:
      - "{{BaseURL}}/favicon.ico"
      - "{{BaseURL}}/favicon.png"
      - "{{BaseURL}}/images/versalogo.png"
      - "{{BaseURL}}/images/versalogo2.png"
      - "{{BaseURL}}/common/images/Logo.png"
      - "{{BaseURL}}/versa/dist/images/versa-logo.png"
      - "{{BaseURL}}/versa/styles/img/versa-logo.png"
      - "{{BaseURL}}/versa/app/img/versa-logo.png"

    stop-at-first-match: true
    matchers:
      - type: dsl
        name: versa-analytics
        dsl:
          - "status_code==200 && (\"-1053531639\" == mmh3(base64_py(body)))"
          - "status_code==200 && (\"-1086395444\" == mmh3(base64_py(body)))"
          - "status_code==200 && (\"186362384\" == mmh3(base64_py(body)))"
          - "status_code==200 && (\"2033952700\" == mmh3(base64_py(body)))"
        condition: or

      - type: dsl
        name: versa-concerto
        dsl:
          - "status_code==200 && (\"-534530225\" == mmh3(base64_py(body)))"
# digest: 4a0a00473045022100ca77e4fe197058ede3b07a4a88a620d46904bac027fe21b35f097e494d67936102203dd4c5fc2210bf5e38624661a0102ee70a78a4a2eefe03bb4d104b32ae0f26bc:922c64590222798bb761d5b6d8e72950