id: suse-manager-panel

info:
  name: SUSE Manager Server - Panel
  severity: info
  author: darses
  description: |
    SUSE Manager login panel detected.
  metadata:
    verify: true
    shodan-query:
      - title:"SUSE Manager - Sign In"
      - title:"SUSE Multi-Linux Manager - Sign In"
      - title:"Uyuni - Sign In"
      - http.favicon.hash:1158194469
    fofa-query:
      - title="SUSE Manager - Sign In"
      - title="SUSE Multi-Linux Manager - Sign In"
      - title="Uyuni - Sign In"
      - icon_hash="1158194469"
  tags: panel,detect,suse,login,discovery

http:
  - method: GET
    path:
      - "{{BaseURL}}"

    redirects: true
    max-redirects: 1

    matchers-condition: and
    matchers:
      - type: word
        words:
          - "<title>SUSE Manager - Sign In</title>"
          - "<title>SUSE Multi-Linux Manager - Sign In</title>"
          - "<title>Uyuni - Sign In</title>"
        condition: or

      - type: status
        status:
          - 200

    extractors:
      - type: regex
        group: 1
        regex:
          - "webVersion:\\s+'([\\d\\.\\s\\w]+)',"
# digest: 490a0046304402205bdeabd5e82ca3c60680bde807e78fa181b08c78799572679b1262490ed171160220775dde2e6a7939c041207f33f11171873754e4b6ba181d87cc9151ccb05a0b45:922c64590222798bb761d5b6d8e72950