id: symfony-files

info:
  name: symfony Disclosure
  author: rix4uni
  severity: critical
  reference:
    - https://twitter.com/nav1n0x/status/1652676328901029888
    - https://twitter.com/SaraBadran18/status/1652344609794654210
    - https://twitter.com/ex16x41/status/1656192083407912961
  metadata:
    google-query:
      - inurl:"/app_dev.php"
    leakix-query:
      - +plugin:SymfonyVerbosePlugin
  tags: config,exposure,symfony

requests:
  - method: GET
    path:
      - "{{BaseURL}}/app_dev.php/_profiler/empty/search/results?limit=100"
      - "{{BaseURL}}/app_dev.php/_profiler/open?file=app/config/parameters.yml"
      - "{{BaseURL}}/app_dev.php/_profiler/phpinfo"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "<title>Symfony Profiler</title>"
          - "Symfony profiler"
          - "<title>Profiler</title>"
          - "<h1>app/config/parameters.yml</h1>"
          - "<title>phpinfo()</title>"
          - "PHP Extension"
          - "PHP Version"

      - type: status
        status:
          - 200