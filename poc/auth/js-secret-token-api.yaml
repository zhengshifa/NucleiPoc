id: js-secret-token-api

info:
  name: Javascript Secret,Token,Api Disclosure
  author: rix4uni
  severity: high
  description: description
  reference:
    - https://
  tags: js,secret,token,api,python,flask

requests:
  - method: GET
    path:
      - '{{BaseURL}}'

    extractors:
      - type: regex
        name: SECRET
        part: body
        regex:
          - (?i)SECRET\s*[:=]\s*["']([^"']+?)["']
          - (?i)SECRET["']\s*[:=]\s*["']([^"']+?)["']

      - type: regex
        name: TOKEN
        part: body
        regex:
          - (?i)TOKEN\s*[:=]\s*["']([^"']+?)["']
          - (?i)TOKEN["']\s*[:=]\s*["']([^"']+?)["']

      - type: regex
        name: API:KEY
        part: body
        regex:
          - (?i)API\s*[:=]\s*["']([^"']+?)["']
          - (?i)KEY\s*[:=]\s*["']([^"']+?)["']
          - (?i)API["']\s*[:=]\s*["']([^"']+?)["']
          - (?i)KEY["']\s*[:=]\s*["']([^"']+?)["']

      - type: regex
        name: SERVER
        part: body
        regex:
          - (?i)SERVER\s*[:=]\s*["']([^"']+?)["']
          - (?i)SERVER["']\s*[:=]\s*["']([^"']+?)["']

      - type: regex
        name: USER:USERNAME
        part: body
        regex:
          - (?i)USER\s*[:=]\s*["']([^"']+?)["']
          - (?i)USERNAME\s*[:=]\s*["']([^"']+?)["']
          - (?i)USER["']\s*[:=]\s*["']([^"']+?)["']
          - (?i)USERNAME["']\s*[:=]\s*["']([^"']+?)["']

      - type: regex
        name: PWD:PASS:PASSWD:PASSWORD
        part: body
        regex:
          - (?i)PWD\s*[:=]\s*["']([^"']+?)["']
          - (?i)PASS\s*[:=]\s*["']([^"']+?)["']
          - (?i)PASSWD\s*[:=]\s*["']([^"']+?)["']
          - (?i)PASSWORD\s*[:=]\s*["']([^"']+?)["']
          - (?i)PWD["']\s*[:=]\s*["']([^"']+?)["']
          - (?i)PASS["']\s*[:=]\s*["']([^"']+?)["']
          - (?i)PASSWD["']\s*[:=]\s*["']([^"']+?)["']
          - (?i)PASSWORD["']\s*[:=]\s*["']([^"']+?)["']

      - type: regex
        name: HOST:DOMAIN
        part: body
        regex:
          - (?i)HOST\s*[:=]\s*["']([^"']+?)["']
          - (?i)DOMAIN\s*[:=]\s*["']([^"']+?)["']
          - (?i)HOST["']\s*[:=]\s*["']([^"']+?)["']
          - (?i)DOMAIN["']\s*[:=]\s*["']([^"']+?)["']

      - type: regex
        name: PORT
        part: body
        regex:
          - (?i)PORT\s*[:=]\s*["']([^"']+?)["']
          - (?i)PORT["']\s*[:=]\s*["']([^"']+?)["']

      - type: regex
        name: ADDRESS
        part: body
        regex:
          - (?i)ADDRESS\s*[:=]\s*["']([^"']+?)["']
          - (?i)ADDRESS["']\s*[:=]\s*["']([^"']+?)["']

      - type: regex
        name: ID
        part: body
        regex:
          - (?i)ID\s*[:=]\s*["']([^"']+?)["']
          - (?i)ID["']\s*[:=]\s*["']([^"']+?)["']

      - type: regex
        name: CREDENTIAL
        part: body
        regex:
          - (?i)CREDENTIAL\s*[:=]\s*["']([^"']+?)["']
          - (?i)CREDENTIAL["']\s*[:=]\s*["']([^"']+?)["']

      - type: regex
        name: URL:URI:LINK:PATH
        part: body
        regex:
          - (?i)URL\s*[:=]\s*["']([^"']+?)["']
          - (?i)URI\s*[:=]\s*["']([^"']+?)["']
          - (?i)LINK\s*[:=]\s*["']([^"']+?)["']
          - (?i)PATH\s*[:=]\s*["']([^"']+?)["']
          - (?i)URL["']\s*[:=]\s*["']([^"']+?)["']
          - (?i)URI["']\s*[:=]\s*["']([^"']+?)["']
          - (?i)LINK["']\s*[:=]\s*["']([^"']+?)["']
          - (?i)PATH["']\s*[:=]\s*["']([^"']+?)["']