id: erlang-otp-ssh-detect

info:
  name: Erlang/OTP SSH Server - Detect
  author: darses
  severity: info
  description: |
    Detects Erlang/OTP SSH servers and parses the version number from the banner.
  metadata:
    shodan-query: 'SSH-2.0-Erlang'
    max-request: 1
    verified: true
  tags: network,ssh,erlang,detect,tcp,discovery

tcp:
  - host:
      - "{{Hostname}}"

    port: 22
    read-size: 1024

    matchers:
      - type: word
        words:
          - "SSH-2.0-Erlang"

    extractors:
      - type: regex
        regex:
          - "SSH-2.0-Erlang/[0-9\\.]+"
# digest: 4b0a00483046022100c94b73fe923cd5a2fcd37ba51d7e14a089cb37c3743f685b3d591d006ce55c89022100854630fe14e6d992f624d77f18d5abb11624703efb2823ce41b7ec783908bc6b:922c64590222798bb761d5b6d8e72950