id: cloudflare-external-image-resize

info:
  name: Cloudflare External Image Resizing Misconfiguration
  author: vavkamil
  severity: info
  description: Cloudflare Image Resizing defaults to restricting resizing to the same domain. This prevents third parties from resizing any image at any origin. However, you can enable this option if you check Resize images from any origin.
  reference:
    - https://support.cloudflare.com/hc/en-us/articles/360028146432-Understanding-Cloudflare-Image-Resizing#12345684
  metadata:
    max-request: 1
  tags: cloudflare,misconfig,oast,vuln

http:
  - raw:
      - |
        GET /cdn-cgi/image/width/https://{{interactsh-url}} HTTP/1.1
        Host: {{Hostname}}
        Accept: */*

    matchers:
      - type: word
        part: interactsh_protocol
        words:
          - "http"
# digest: 4a0a004730450220475a1cfbad8382c34e4395587eccee588bbcdc6630c877c3912992691030c3d2022100f7a2c5f9476b102791359b493f1f88c5187825d63eb3ad2bdd80b16872a26358:922c64590222798bb761d5b6d8e72950