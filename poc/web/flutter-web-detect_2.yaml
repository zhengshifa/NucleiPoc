id: flutter-web-detect

info:
  name: Flutter Web Application - Detect
  author: incogbyte
  severity: info
  description: |
    Detect flutter web apps looking for flutter_bootstrap.js,main.dart.js and flutter_service_worker.js files.
  metadata:
    max-request: 1
    verified: true
    shodan-query: http.html:"flutter_bootstrap.js"
    fofa-query: body="flutter_bootstrap.js"
  tags: tech,detect,flutter,discovery

http:
  - method: GET
    path:
      - "{{BaseURL}}/flutter_service_worker.js"
      - "{{BaseURL}}/main.dart.js"
      - "{{BaseURL}}/flutter_bootstrap.js"

    stop-at-first-match: true
    matchers:
      - type: word
        part: body
        words:
          - "_flutter.loader.didCreateEngineInitializer"
          - "_flutter.buildConfig"
          - "flutter-app-manifest"
          - "flutter-temp-cache"
          - "flutter-app-cache"
          - "ext.flutter.disassemble"
          - "#flutterweb-theme"
        condition: or
# digest: 4b0a00483046022100e095e1caca09f5e8bac20ac6359ef8dff7275773dacdf1ae7f4ef183f12614d8022100af598289becee94343ca4f3fcd08b41b6a1983d3a1dcdb9b7db80898ab42b536:922c64590222798bb761d5b6d8e72950