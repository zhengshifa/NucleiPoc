id: generic-api-tokens

info:
  name: Generic Api & Tokens Detection
  author: rix4uni
  severity: info
  metadata:
    verified: "true"
  tags: github,token,exposure

requests:
  - method: GET
    path:
      - "{{BaseURL}}"

    extractors:
      - type: regex
        name: github-personal-access
        part: body
        regex:
          - '\b(ghp_[a-zA-Z0-9]{36})\b'

      - type: regex
        name: github-app
        part: body
        regex:
          - '\b((?:ghu|ghs)_[a-zA-Z0-9]{36})\b'

      - type: regex
        name: github-oauth-access
        part: body
        regex:
          - '\b(gho_[a-zA-Z0-9]{36})\b'

      - type: regex
        name: github-refresh
        part: body
        regex:
          - '\b(ghr_[a-zA-Z0-9]{76})\b'

      - type: regex
        name: github-OAuth-2.0-ID
        part: body
        regex:
          - '[A-Za-z0-9_]{255}'

      - type: regex
        name: adobe-oauth-secret
        part: body
        regex:
          - '(?i)\b(p8e-[a-z0-9-]{32})(?:[^a-z0-9-]|$)'

      - type: regex
        name: age-public-key
        part: body
        regex:
          - '\bage1[0-9a-z]{58}\b'

      - type: regex
        name: age-secret-key
        part: body
        regex:
          - '\bAGE-SECRET-KEY-1[0-9A-Z]{58}\b'

      - type: regex
        name: amazon-mws-auth-token
        part: body
        regex:
          - "amzn\\.mws\\.[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}"

      - type: regex
        name: amazon-sns-topic
        part: body
        regex:
          - 'arn:aws:sns:[a-z0-9\-]+:[0-9]+:[A-Za-z0-9\-_]+'

      - type: regex
        name: aws-access-key-value
        part: body
        regex:
          - "(A3T[A-Z0-9]|AKIA|AGPA|AROA|AIPA|ANPA|ANVA|ASIA)[A-Z0-9]{16}"

      - type: regex
        name: aws-account-id
        part: body
        regex:
          - '(?i)aws_?(?:account)_?(?:id)?["''`]?\s{0,30}(?::|=>|=)\s{0,30}["''`]?([0-9]{4}-?[0-9]{4}-?[0-9]{4})'

      - type: regex
        name: aws-api-key
        part: body
        regex:
          - '\b((?:A3T[A-Z0-9]|AKIA|AGPA|AIDA|AROA|AIPA|ANPA|ANVA|ASIA)[A-Z0-9]{16})\b'

      - type: regex
        name: aws-session-token
        part: body
        regex:
          - '(?i)(?:aws.?session|aws.?session.?token|aws.?token)["''`]?\s{0,30}(?::|=>|=)\s{0,30}["''`]?([a-z0-9/+=]{16,200})[^a-z0-9/+=]'

      - type: regex
        name: artifactory-api-password
        part: body
        regex:
          - '(?:\s|=|:|"|^)AP[\dABCDEF][a-zA-Z0-9]{8,}'

      - type: regex
        name: artifactory-api-token
        part: body
        regex:
          - '(?:\s|=|:|"|^)AKC[a-zA-Z0-9]{10,}'

      - type: regex
        name: bitly-secret-key
        part: body
        regex:
          - 'R_[0-9a-f]{32}'

      - type: regex
        name: cloudinary-credentials
        part: body
        regex:
          - 'cloudinary://[0-9]+:[A-Za-z0-9\-_\.]+@[A-Za-z0-9\-_\.]+'

      - type: regex
        name: codeclimate-token
        part: body
        regex:
          - '(?i)codeclima.{0,50}\b([a-f0-9]{64})\b'

      - type: regex
        name: crates-api-key
        part: body
        regex:
          - '\bcio[a-zA-Z0-9]{32}\b'

      - type: regex
        name: discord-webhook
        part: body
        regex:
          - 'https://discordapp\.com/api/webhooks/[0-9]+/[A-Za-z0-9\-]+'

      - type: regex
        name: dynatrace-api-token
        part: body
        regex:
          - '\b(dt0[a-zA-Z]{1}[0-9]{2}\.[A-Z0-9]{24}\.[A-Z0-9]{64})\b'

      - type: regex
        name: facebook-access-token
        part: body
        regex:
          - '\b(EAACEdEose0cBA[a-zA-Z0-9]+)\b'

      - type: regex
        name: jdbc-connection-string
        part: body
        regex:
          - 'jdbc:[a-z:]+://[A-Za-z0-9\.\-_:;=/@?,&]+'

      - type: regex
        name: jwt-token
        part: body
        regex:
          - 'eyJ[a-zA-Z0-9]{10,}\.eyJ[a-zA-Z0-9]{10,}\.[a-zA-Z0-9_\-]{10,}'

      - type: regex
        name: gitlab-runner-token
        part: body
        regex:
          - '\b(GR1348941[0-9a-zA-Z_-]{20})(?:\b|$)'

      - type: regex
        name: gitlab-personal-token
        part: body
        regex:
          - '\b(glpat-[0-9a-zA-Z_-]{20})(?:\b|$)'

      - type: regex
        name: gitlab-pipeline-token
        part: body
        regex:
          - '\b(glptt-[0-9a-f]{40})\b'

      - type: regex
        name: google-oauth-access-key
        part: body
        regex:
          - 'ya29\.[0-9A-Za-z\-_]+'

      - type: regex
        name: google-OAuth-2.0-Secret
        part: body
        regex:
          - '[0-9a-zA-Z\-_]{24}'

      - type: regex
        name: fcm-server-key
        part: body
        regex:
          - "AAAA[a-zA-Z0-9_-]{7}:[a-zA-Z0-9_-]{140}"

      - type: regex
        name: google-api-key
        part: body
        regex:
          - "AIza[0-9A-Za-z\\-_]{35}"

      - type: regex
        name: google-OAuth-2.0-Refresh-Token
        part: body
        regex:
          - '1/[0-9A-Za-z\-_]{43}|1/[0-9A-Za-z\-_]{64}'

      - type: regex
        name: google-calendar-link
        part: body
        regex:
          - 'https://www\.google\.com/calendar/embed\?src=[A-Za-z0-9%@&;=\-_\./]+'

      - type: regex
        name: google-client-id
        part: body
        regex:
          - '(?i)\b([0-9]+-[a-z0-9_]{32})\.apps\.googleusercontent\.com'

      - type: regex
        name: google-oauth-prefixed
        part: body
        regex:
          - '(GOCSPX-[a-zA-Z0-9_-]{28})'

      - type: regex
        name: heroku-api-key
        part: body
        regex:
          - '(?i)heroku.{0,20}key.{0,20}\b([0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12})\b'

      - type: regex
        name: jenkins-crumb-token
        part: body
        regex:
          - '(?i)jenkins.{0,10}(?:crumb)?.{0,10}\b([0-9a-f]{32,36})\b'

      - type: regex
        name: loqate-api-key
        part: body
        regex:
          - "[A-Z]{2}[0-9]{2}-[A-Z]{2}[0-9]{2}-[A-Z]{2}[0-9]{2}-[A-Z]{2}[0-9]{2}"

      - type: regex
        name: mailchimp-access-key-value
        part: body
        regex:
          - "[0-9a-f]{32}-us[0-9]{1,2}"

      - type: regex
        name: mailgun-api-token
        part: body
        regex:
          - '(?i)(?:mailgun|mg).{0,20}key-([a-z0-9]{32})\b'

      - type: regex
        name: mapbox-token-disclosure
        part: body
        regex:
          - 'sk\.eyJ1Ijoi\w+\.[\w-]*'

      - type: regex
        name: microsoft-teams-webhook
        part: body
        regex:
          - 'https://outlook\.office\.com/webhook/[A-Za-z0-9\-@]+/IncomingWebhook/[A-Za-z0-9\-]+/[A-Za-z0-9\-]+'

      - type: regex
        name: newrelic-synthetics-location-key
        part: body
        regex:
          - '(?i)NRSP-[a-z]{2}[0-9]{2}[a-f0-9]{31}'

      - type: regex
        name: newrelic-admin-api-key
        part: body
        regex:
          - '(?i)NRAA-[a-f0-9]{27}'

      - type: regex
        name: newrelic-insights-key
        part: body
        regex:
          - '(?i)NRI(?:I|Q)-[A-Za-z0-9\-_]{32}'

      - type: regex
        name: newrelic-pixie-api-key
        part: body
        regex:
          - "(px-api-[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12})"

      - type: regex
        name: newrelic-pixie-deploy-key
        part: body
        regex:
          - "(px-dep-[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12})"

      - type: regex
        name: newrelic-rest-api-key
        part: body
        regex:
          - '(?i)NRRA-[a-f0-9]{42}'

      - type: regex
        name: npm-access-token
        part: body
        regex:
          - "(npm_[A-Za-z0-9]{36})"

      - type: regex
        name: nuget-api-key
        part: body
        regex:
          - "(oy2[a-z0-9]{43})"

      - type: regex
        name: openai-api-key
        part: body
        regex:
          - "(sk-[a-zA-Z0-9]{48})" 

      - type: regex
        name: braintree-access-token
        part: body
        regex:
          - 'access_token\$production\$[0-9a-z]{16}\$[0-9a-f]{32}'

      - type: regex
        name: picatic-api-key
        part: body
        regex:
          - 'sk_live_[0-9a-z]{32}'

      - type: regex
        name: pypi-upload-token
        part: body
        regex:
          - "(pypi-AgEIcHlwaS5vcmc[a-zA-Z0-9_-]{50,})" 

      - type: regex
        name: razorpay-clientid-disclosure
        part: body
        regex:
          - "rzp_(live|test)_.{14}"

      - type: regex
        name: rubygems-api-key
        part: body
        regex:
          - "(rubygems_[a-f0-9]{48})"

      - type: regex
        name: sauce-token
        part: body
        regex:
          - '(?i)sauce.{0,50}\b([a-f0-9-]{36})\b'

      - type: regex
        name: segment-public-token
        part: body
        regex:
          - '(sgp_[a-zA-Z0-9]{64})'

      - type: regex
        name: sendgrid-api-key
        part: body
        regex:
          - 'SG\.[a-zA-Z0-9-_]{22}\.[a-zA-Z0-9_-]{43}'

      - type: regex
        name: shopify-public-token
        part: body
        regex:
          - '\b(shpat_[a-fA-F0-9]{32})\b'

      - type: regex
        name: shopify-app-secret
        part: body
        regex:
          - '\b(shpss_[a-fA-F0-9]{32})\b'

      - type: regex
        name: shopify-customapp-token
        part: body
        regex:
          - '\b(shpca_[a-fA-F0-9]{32})\b'

      - type: regex
        name: shopify-legacy-token
        part: body
        regex:
          - '\b(shppa_[a-fA-F0-9]{32})\b'

      - type: regex
        name: slack-webhook-token
        part: body
        regex:
          - "https://hooks\\.slack\\.com/services/T[a-zA-Z0-9_]{8}/B[a-zA-Z0-9_]{8}/[a-zA-Z0-9_]{24}"

      - type: regex
        name: slack-bot-token
        part: body
        regex:
          - "xoxb-[0-9A-Za-z\\-]{51}"

      - type: regex
        name: slack-user-token
        part: body
        regex:
          - "xoxp-[0-9A-Za-z\\-]{72}"

      - type: regex
        name: sonarqube-token
        part: body
        regex:
          - "sonar.{0,50}(?:\"|'|`)?[0-9a-f]{40}(?:\"|'|`)?" 

      - type: regex
        name: square-oauth-secret-token
        part: body
        regex:
          - '(?i)\b(sq0csp-[a-z0-9_-]{43})\b'

      - type: regex
        name: square-access
        part: body
        regex:
          - '(?i)\b(sq0atp-[a-z0-9_-]{22})\b'

      - type: regex
        name: stackhawk-api
        part: body
        regex:
          - '\b(hawk\.[0-9A-Za-z_-]{20}\.[0-9A-Za-z_-]{20})\b'

      - type: regex
        name: stripe-secret-key
        part: body
        regex:
          - 'sk_(?:live|test)_[0-9a-zA-Z]{24}'

      - type: regex
        name: stripe-restricted-key
        part: body
        regex:
          - 'rk_(?:live|test)_[0-9a-zA-Z]{24}'

      - type: regex
        name: telegram-bot-token
        part: body
        regex:
          - '\b(\d+:AA[a-zA-Z0-9_-]{32,33})'

      - type: regex
        name: twilio-api-key
        part: body
        regex:
          - '(?i)twilio.{0,20}\b(sk[a-f0-9]{32})\b'

      - type: regex
        name: zapier-webhook-token
        part: body
        regex:
          - 'https://(?:www.)?hooks\.zapier\.com/hooks/catch/[A-Za-z0-9]+/[A-Za-z0-9]+/'

      - type: regex
        name: zoho-webhook-token
        part: body
        regex:
          - 'https://creator\.zoho\.com/api/[A-Za-z0-9/\-_\.]+\?authtoken=[A-Za-z0-9]+'

      - type: regex
        name: sanity_api_token
        part: body
        regex:
          - '\b(sk[a-zA-Z0-9]{178})\b'

      - type: regex
        name: possible algolia-api-key,trello_api,1forge-api-key,abstractapi
        part: body
        regex:
          - '\b([a-zA-Z0-9]{32})\b'

      - type: regex
        name: possible xsolla-api-key
        part: body
        regex:
          - '\b([a-zA-Z0-9]{40})\b'

      - type: regex
        name: omise-secret-key
        part: body
        regex:
          - '\b(skey_test_[a-zA-Z0-9]{19})\b'

      - type: regex
        name: possible trello_token,alienvault-api,binance-api
        part: body
        regex:
          - '\b([a-zA-Z0-9]{64})\b'

      - type: regex
        name: possible abuseipdb-api
        part: body
        regex:
          - '\b([a-zA-Z0-9]{80})\b'

      - type: regex
        name: possible adoptapet-api
        part: body
        regex:
          - '\b([a-zA-Z0-9]{33})\b'

      - type: regex
        name: possible airtable-api
        part: body
        regex:
          - '\b([a-zA-Z0-9]{14})\b'

      - type: regex
        name: possible amdoren-api
        part: body
        regex:
          - '\b([a-zA-Z0-9]{30})\b'

      - type: regex
        name: possible bitcoinaverage-api
        part: body
        regex:
          - '\b([a-zA-Z0-9]{43})\b'

      - type: regex
        name: possible bitrise-api
        part: body
        regex:
          - '\b([a-zA-Z0-9]{86})\b'

      - type: regex
        name: possible blitapp-api
        part: body
        regex:
          - '\b([a-zA-Z0-9-_.~]{35,48})\b'

      - type: regex
        name: possible block.io-api
        part: body
        regex:
          - '\b([a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{4})\b'

      - type: regex
        name: possible api.blockchain.com-api
        part: body
        regex:
          - '\b([a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[0-9a-f]{12})\b'

      - type: regex
        name: possible blockfrost-mainnet-api
        part: body
        regex:
          - '\b(mainnet[a-zA-Z0-9]{32})\b'

      - type: regex
        name: possible blockfrost-testnet-api
        part: body
        regex:
          - '\b(testnet[a-zA-Z0-9]{32})\b'

      - type: regex
        name: possible blockfrost-ipfs-api
        part: body
        regex:
          - '\b(ipfs[a-zA-Z0-9]{32})\b'

      - type: regex
        name: possible bravenewcoin-api
        part: body
        regex:
          - '\b([a-zA-Z0-9]{50})\b'

      - type: regex
        name: dropbox-api
        part: body
        regex:
          - '\b(sl.[a-zA-Z0-9-_]{136})\b'

      - type: regex
        name: twitter-access-token
        part: body
        regex:
          - '[1-9][ 0-9]+-[0-9a-zA-Z]{40}'

      - type: regex
        name: twitter-username
        part: body
        regex:
          - '/(^|[^@\w])@(\w{1,15})\b/'

      - type: regex
        name: facebook-OAuth-2.0
        part: body
        regex:
          - '[A-Za-z0-9]{125} (counting letters [2])'

      - type: regex
        name: instagram-OAuth-2.0
        part: body
        regex:
          - '[0-9a-fA-F]{7}\.[0-9a-fA-F]{32}'

      - type: regex
        name: Foursquare-Client-Key
        part: body
        regex:
          - '[0-9a-zA-Z_][5,31]'

      - type: regex
        name: Foursquare-Secret-Key
        part: body
        regex:
          - 'R_[0-9a-f]{32}'

      - type: regex
        name: Google-Cloud-Platform-OAuth-2.0
        part: body
        regex:
          - '[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}'

      - type: regex
        name: Google-Cloud-Platform-API-Key
        part: body
        regex:
          - '[A-Za-z0-9_]{21}--[A-Za-z0-9_]{8}'